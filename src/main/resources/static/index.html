<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <title>Anguchat</title>
</head>
<body>
<div>Hello there</div>

<div ng-app="anguchatApp" ng-controller="anguchatCtrl">

    <div class="text-center">

        <ul>
            <li ng-repeat='(key, value) in chatRoom'>
                <span>{{value}}</span>
            </li>
        </ul>

    </div>
    <br/>
    <input type="text" ng-model="msg">
    <button ng-click="sendMsg()">CLICK</button>
    <br/>
    <div>{{result}}</div>
    <br/>
    <div>{{msg}}</div>
</div>

<script>
    var app = angular.module('anguchatApp', []);
    app.controller('anguchatCtrl', function ($scope, $http, $interval) {
        function askForChatRoom() {
            $http({
                method: "GET",
                url: "chat"
            }).then(function ok(value) {
                    $scope.chatRoom = value.data;
                },
                function notOK(reason) {
                    $scope.result = "fail";
                });
        };
        $scope.sendMsg = function () {
            $http({
                method: "POST",
                url: "message",
                data: {msg: $scope.msg}
            }).then(function ok(value) {
                    $scope.result = "ok";
                    $scope.msg = "";
                },
                function notOK(reason) {
                    $scope.result = "fail";
                })
        };
        $interval(function(){askForChatRoom()}, 5000)
    });


</script>
</body>
</html>